-- DDL STATEMENT
CREATE TABLE city (
id number primary key,
city varchar2(100)
);

DESC city;

CREATE TABLE person (
id number,
name varchar2(100) NOT NULL,
birthdate date,
email varchar2(100),
salary number DEFAULT 3000,
sexe char(1),
id_city number,
CONSTRAINT person_pk PRIMARY KEY(id),
CONSTRAINT email_uq unique(email),
CONSTRAINT sexe_ck check (sexe in ('H','F')),
CONSTRAINT salary_ck CHECK (salary > 3000),
CONSTRAINT city_fk FOREIGN KEY(id_city) REFERENCES city(id)
);



INSERT INTO city VALUES (1,'casablanca');
INSERT INTO city VALUES (2,'rabat');
INSERT INTO city VALUES (3,'oujda');

SELECT * FROM city;

INSERT INTO person VALUES (1,'imran',to_date('1987-04-10','YYYY-MM-DD'),'yazidi.mran@gmail.com',10000,'H',1);

-- This statement show this error: ORA-00001: unique constraint (SYSTEM.EMAIL_UQ) violated
INSERT INTO person VALUES (2,'imran',to_date('1987-04-10','YYYY-MM-DD'),'yazidi.mran@gmail.com',10000,'H',1);

-- This statement show this error: ORA-02290: check constraint (SYSTEM.SALARY_CK) violated
INSERT INTO person VALUES (2,'imran',to_date('1987-04-10','YYYY-MM-DD'),'yazidi.omar@gmail.com',2000,'H',1);

-- This statement show this error: ORA-02290: check constraint (SYSTEM.SEXE_CK) violated
INSERT INTO person VALUES (2,'imran',to_date('1987-04-10','YYYY-MM-DD'),'yazidi.omar@gmail.com',12000,'x',1);

-- This statement show this error: ORA-02291: integrity constraint (SYSTEM.CITY_FK) violated - parent key not found
INSERT INTO person VALUES (2,'imran',to_date('1987-04-10','YYYY-MM-DD'),'yazidi.omar@gmail.com',12000,'H',5);


ALTER TABLE person DROP CONSTRAINT city_fk;
ALTER TABLE person ADD CONSTRAINT city_fk FOREIGN KEY(id_city) REFERENCES city(id) ON DELETE SET NULL;


ALTER TABLE person DROP CONSTRAINT city_fk;
ALTER TABLE person ADD CONSTRAINT city_fk FOREIGN KEY(id_city) REFERENCES city(id) ON DELETE CASCADE;


SELECT * FROM person;
SELECT * FROM city;

DELETE FROM city WHERE id=1;

UPDATE PERSON SET id_city=1 WHERE id=1;

DESC person;

SELECT * FROM user_tables;
SELECT * FROM user_constraints;


